#header#

<section id="main-content">
    <section class="wrapper">
        <div class="row">
            <div class="col-lg-12">
                <ul class="breadcrumb">
                    <li>
                        <a href="index.php">
                            <i class="fa fa-home"></i>
                            Home
                        </a>
                    </li>
                    <li class="active">Edit publication</li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">
                <section class="panel">
                    <header class="panel-heading">
                        Publication
                    </header>
                    <div class="panel-body">
                        <form action="publication-edit.php" method="post" name="publication_edit_form" class="form-horizontal tasi-form" id="publication_edit_form" enctype="multipart/form-data">
                            #msg#
                            <div class="form-group">
                                <div class="col-sm-3 control-label">Publication Image:</div>
                                <div class="col-sm-7">
                                    <div class="fileupload fileupload-exists" data-provides="fileupload" data-name="#publication_image#">
                                        <input type="hidden" value="#publication_image#" name="publication_image" />
                                        <div class="fileupload-new thumbnail" style="width: 200px; height: 150px;">
                                            <img src="img/no_image.jpeg" alt="" />
                                        </div>
                                        <div class="fileupload-preview fileupload-exists thumbnail" style="max-width: 200px; max-height: 150px; line-height: 20px;"><img src="img/publications/#publication_image#" /></div>
                                        <div>
                                            <span class="btn btn-white btn-file">
                                                <span class="fileupload-new"><i class="fa fa-paper-clip"></i> Select image</span>
                                                <span class="fileupload-exists"><i class="fa fa-undo"></i> Change</span>
                                                <input type="file" class="default" name="publication_image" id="publication_image" />
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-3 control-label">Link File:</div>
                                <div class="col-sm-7">
                                    <select class="form-control" id="file_name" name="file_name">
                                        <option value = "">Please select a file</option>
                                        #fileLst#
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-3 control-label">Title:</div>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control" name="publication_title" id="publication_title" value="#publication_title#" />
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-3 control-label">Publication Content:</div>
                                <div class="col-sm-7">
                                    <textarea class="form-control ckeditor" name="publication_content" id="publication_content">#publication_content#</textarea>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-5 control-label">&nbsp;</div>
                                <div class="col-sm-2">
                                    <input type="submit" value="Update" class="btn btn-info" name="submit" />
                                    <input type="button" value="Cancel" class="btn btn-info" name="cancel" id="cancel" />
                                </div>
                            </div>
                            <input type="hidden" name="publication_id" id="publication_id" value="#publication_id#" />
                        </form>
                    </div>
                </section>
            </div>
        </div>
    </section>
</section>

<script type="text/javascript" src="assets/ckeditor/ckeditor.js"></script>

<script type="text/javascript" src="assets/bootstrap-fileupload/bootstrap-fileupload.js"></script>
<link rel="stylesheet" type="text/css" href="assets/bootstrap-fileupload/bootstrap-fileupload.css" />

<script type="text/javascript" src="js/jquery.validate.min.js"></script>

<style type="text/css">
    label.error {
        color: #b94a48;
        font-weight: normal;
        font-size: 12px;
    }
</style>

<script type="text/javascript" charset="utf-8">
    $("#cancel").click(function () {
        top.location.href = "publication.php?msg='canceled'";
    });

    $(document).ready(function () {
        $('#publication_image').change(function () {
            var file_size = parseFloat(this.files[0].size / 1024 / 1024 + "MB").toFixed(2);
            var val = $(this).val().toLowerCase();
            var regex = new RegExp("(.*?)\.(jpg|jpeg|png|tiff)$");
            if (!(regex.test(val))) {
                $(this).val('');
                sweetAlert('Error', 'Only JPG, JPEG, and PNG files are accepted.', 'error');
            } else if (file_size > 5) {
                $(this).val('');
                sweetAlert('Error', 'File size cannot exceed more than 5 MB', 'error');
            }
        });

        $('#publication_document').change(function () {
            var file_size = parseFloat(this.files[0].size / 1024 / 1024 + "MB").toFixed(2);
            var val = $(this).val().toLowerCase();
            var regex = new RegExp("(.*?)\.(pdf|zip|rar|tar|gzip|7z|jpg|jpeg|tiff|png|doc|docx|xls|xlsx|ppt|pptx|txt)$");
            if (!(regex.test(val))) {
                $(this).val('');
                sweetAlert('Error', 'Only PDF, ZIP, RAR, TAR, GZIP, 7Z, JPG, JPEG, TIFF, PNG, DOC, DOCX, XLS, XLSX, PPT, PPTX, and TXT files are accepted.', 'error');
            }
            else if (file_size > 1000) {
                $(this).val('');
                sweetAlert('Error', 'File size cannot exceed more than 1 GB', 'error');
            }
        });

        $("#publication_edit_form").validate({
            rules: {
                title: {required: true, maxlength: 200}
            },
            messages: {
                title: {required: 'Please enter publication title'}
            }
        });
    });
</script>

#footer#